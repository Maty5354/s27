/* ========================================
   DEPTH.CSS — Anti-flatness layer
   Drop this into index.html after variables.css
   ======================================== */

/* ── 1. Ambient grain texture on the page background ── */
body::after {
    content: "";
    position: fixed;
    inset: 0;
    z-index: -999;
    pointer-events: none;
    opacity: 0.035;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    background-size: 160px 160px;
}

/* ── 2. Richer background — subtle radial glow behind content ── */
body::before {
    content: "";
    position: fixed;
    inset: 0;
    z-index: -1000;
    pointer-events: none;
    background:
        radial-gradient(ellipse 80% 50% at 20% 10%, color-mix(in srgb, var(--accent-color) 6%, transparent), transparent),
        radial-gradient(ellipse 60% 40% at 80% 90%, color-mix(in srgb, var(--accent-secondary) 5%, transparent), transparent);
    transition: background 0.6s ease;
}

/* ── 3. Cards — multi-layer shadow + inner highlight ── */
.timetable-wrapper,
.container,
.side-menu,
.manuals-popup,
.info-overlay-container,
.weather-overlay-container,
.advanced-todo-container,
.task-edit-container,
.folder-edit-container,
.customization-container {
    box-shadow:
        0 1px 0 0 color-mix(in srgb, white 8%, transparent) inset,   /* top inner highlight */
        0 -1px 0 0 color-mix(in srgb, black 8%, transparent) inset,  /* bottom inner shadow */
        0 4px 8px -2px color-mix(in srgb, var(--shadow-color) 60%, transparent),
        0 12px 24px -6px color-mix(in srgb, var(--shadow-color) 40%, transparent),
        0 32px 48px -16px color-mix(in srgb, var(--shadow-color) 25%, transparent);
}

/* ── 4. Timetable cells — subtle bevel ── */
.timetable th,
.timetable td {
    background-image: linear-gradient(
        180deg,
        color-mix(in srgb, white 3%, transparent) 0%,
        transparent 40%,
        color-mix(in srgb, black 2%, transparent) 100%
    );
}

/* ── 5. Title container — glass depth ── */
.title-container {
    box-shadow:
        0 1px 0 0 color-mix(in srgb, white 20%, transparent) inset,
        0 -1px 0 0 color-mix(in srgb, black 6%, transparent) inset,
        0 8px 32px -8px color-mix(in srgb, var(--accent-color) 15%, var(--shadow-color)),
        0 2px 8px -2px color-mix(in srgb, var(--shadow-color) 50%, transparent);
    border-top: 1px solid color-mix(in srgb, white 18%, transparent);
    border-bottom: 1px solid color-mix(in srgb, black 10%, transparent);
}

/* ── 6. Accent-colored glow on current/active cells ── */
.timetable td.current-cell,
.timetable th.current-cell {
    box-shadow:
        0 0 0 1px color-mix(in srgb, var(--accent-color) 50%, transparent) inset,
        0 4px 16px -4px color-mix(in srgb, var(--accent-color) 40%, transparent);
}

.timetable th.current-day {
    box-shadow: 0 3px 0 0 var(--accent-color) inset;
}

/* ── 7. Menu buttons — lifted feel ── */
.menu-btn {
    box-shadow:
        0 1px 0 0 color-mix(in srgb, white 6%, transparent) inset,
        0 -1px 0 0 color-mix(in srgb, black 6%, transparent) inset,
        0 2px 4px -1px color-mix(in srgb, var(--shadow-color) 60%, transparent);
    border: 1px solid color-mix(in srgb, var(--border-color) 80%, transparent);
    background-image: linear-gradient(
        180deg,
        color-mix(in srgb, white 3%, transparent) 0%,
        transparent 100%
    );
    transition: box-shadow var(--transition-speed) ease, transform var(--transition-speed) ease, background var(--transition-speed) ease;
}

@media (hover: hover) {
    .menu-btn:hover {
        box-shadow:
            0 1px 0 0 color-mix(in srgb, white 10%, transparent) inset,
            0 -1px 0 0 color-mix(in srgb, black 8%, transparent) inset,
            0 4px 12px -2px color-mix(in srgb, var(--accent-color) 20%, var(--shadow-color)),
            0 2px 6px -2px color-mix(in srgb, var(--shadow-color) 60%, transparent);
        transform: translateY(-1px);
    }
}

/* ── 8. Control buttons ── */
.control-btn,
.modal-btn.primary {
    box-shadow:
        0 1px 0 0 color-mix(in srgb, white 20%, transparent) inset,
        0 -2px 0 0 color-mix(in srgb, black 15%, transparent) inset,
        0 4px 12px -2px color-mix(in srgb, var(--accent-color) 40%, transparent),
        0 2px 4px -1px color-mix(in srgb, black 20%, transparent);
    border-bottom: 2px solid color-mix(in srgb, var(--accent-color) 60%, black);
}

@media (hover: hover) {
    .control-btn:hover,
    .modal-btn.primary:hover {
        box-shadow:
            0 1px 0 0 color-mix(in srgb, white 25%, transparent) inset,
            0 -2px 0 0 color-mix(in srgb, black 15%, transparent) inset,
            0 8px 20px -4px color-mix(in srgb, var(--accent-color) 55%, transparent),
            0 2px 4px -1px color-mix(in srgb, black 25%, transparent);
    }
}

.control-btn:active,
.modal-btn.primary:active {
    transform: translateY(1px);
    box-shadow:
        0 -1px 0 0 color-mix(in srgb, white 10%, transparent) inset,
        0 1px 0 0 color-mix(in srgb, black 10%, transparent) inset,
        0 2px 4px -2px color-mix(in srgb, var(--accent-color) 30%, transparent);
    border-bottom-width: 1px;
}

/* ── 9. Side menu — depth layering ── */
.side-menu {
    box-shadow:
        1px 0 0 0 color-mix(in srgb, white 5%, transparent) inset,
        4px 0 16px -4px color-mix(in srgb, black 25%, transparent),
        12px 0 40px -12px color-mix(in srgb, black 15%, transparent);
    background-image: linear-gradient(
        180deg,
        color-mix(in srgb, var(--accent-color) 3%, var(--card-bg)) 0%,
        var(--card-bg) 30%
    );
}

/* ── 10. Bottom navbar glass depth ── */
.bottom-navbar {
    box-shadow:
        0 -1px 0 0 color-mix(in srgb, white 10%, transparent) inset,
        0 -8px 24px -8px color-mix(in srgb, var(--shadow-color) 60%, transparent),
        0 -2px 8px -4px color-mix(in srgb, black 15%, transparent);
}

/* ── 11. Active nav item pill ── */
.nav-item.active::after {
    box-shadow: 0 0 8px 2px color-mix(in srgb, var(--accent-color) 60%, transparent);
}

/* ── 12. Today cards — stacked paper effect ── */
.today-card {
    box-shadow:
        0 1px 0 0 color-mix(in srgb, white 8%, transparent) inset,
        0 2px 4px -1px color-mix(in srgb, var(--shadow-color) 50%, transparent),
        0 6px 16px -6px color-mix(in srgb, var(--shadow-color) 35%, transparent);
    border-top: 1px solid color-mix(in srgb, white 6%, transparent);
}

@media (hover: hover) {
    .today-card:hover {
        box-shadow:
            0 1px 0 0 color-mix(in srgb, white 12%, transparent) inset,
            0 4px 12px -2px color-mix(in srgb, var(--accent-color) 20%, var(--shadow-color)),
            0 12px 28px -8px color-mix(in srgb, var(--shadow-color) 40%, transparent);
    }
}

/* ── 13. Todo task items ── */
.task-item {
    box-shadow:
        0 1px 0 0 color-mix(in srgb, white 6%, transparent) inset,
        0 2px 4px -1px color-mix(in srgb, var(--shadow-color) 40%, transparent),
        0 6px 12px -6px color-mix(in srgb, var(--shadow-color) 25%, transparent);
    background-image: linear-gradient(
        180deg,
        color-mix(in srgb, white 2%, transparent) 0%,
        transparent 100%
    );
}

@media (hover: hover) {
    .task-item:hover {
        box-shadow:
            0 1px 0 0 color-mix(in srgb, white 10%, transparent) inset,
            0 4px 16px -4px color-mix(in srgb, var(--accent-color) 15%, var(--shadow-color)),
            0 12px 32px -8px color-mix(in srgb, var(--shadow-color) 30%, transparent);
    }
}

/* ── 14. Folder items ── */
.folder-item.active {
    box-shadow:
        0 1px 0 0 color-mix(in srgb, white 10%, transparent) inset,
        0 2px 8px -2px color-mix(in srgb, var(--folder-color, var(--accent-color)) 30%, transparent),
        0 0 0 1px color-mix(in srgb, var(--folder-color, var(--accent-color)) 20%, transparent);
}

/* ── 15. Customization sidebar items ── */
.sidebar-item.active {
    box-shadow:
        3px 0 0 0 var(--accent-color) inset,
        4px 0 12px -4px color-mix(in srgb, var(--accent-color) 25%, transparent);
}

/* ── 16. Input focus ring — glowing depth ── */
.cb-range::-webkit-slider-thumb,
.cb-range::-moz-range-thumb {
    box-shadow:
        0 0 0 3px var(--card-bg),
        0 0 0 5px color-mix(in srgb, var(--accent-color) 60%, transparent),
        0 4px 8px -2px color-mix(in srgb, var(--accent-color) 40%, transparent);
}

.cb-toggle input:checked ~ .cb-toggle-track {
    box-shadow:
        0 0 0 1px color-mix(in srgb, var(--accent-color) 80%, transparent) inset,
        0 2px 8px -2px color-mix(in srgb, var(--accent-color) 50%, transparent);
}

/* ── 17. Mobile bottom sheet ── */
.bottom-sheet {
    box-shadow:
        0 -1px 0 0 color-mix(in srgb, white 12%, transparent) inset,
        0 -16px 48px -8px color-mix(in srgb, black 30%, transparent),
        0 -4px 16px -4px color-mix(in srgb, black 20%, transparent);
}

/* ── 18. Quick filter active state ── */
.quick-filter.active {
    box-shadow:
        0 1px 0 0 color-mix(in srgb, white 15%, transparent) inset,
        0 -2px 0 0 color-mix(in srgb, black 15%, transparent) inset,
        0 4px 12px -2px color-mix(in srgb, var(--accent-color) 35%, transparent);
}

/* ── 19. Sheet menu buttons ── */
.sheet-menu-btn {
    box-shadow:
        0 1px 0 0 color-mix(in srgb, white 6%, transparent) inset,
        0 2px 6px -2px color-mix(in srgb, var(--shadow-color) 40%, transparent);
    background-image: linear-gradient(
        160deg,
        color-mix(in srgb, white 3%, transparent) 0%,
        transparent 60%
    );
}

@media (hover: hover) {
    .sheet-menu-btn:hover {
        box-shadow:
            0 1px 0 0 color-mix(in srgb, white 10%, transparent) inset,
            0 4px 16px -4px color-mix(in srgb, var(--accent-color) 25%, var(--shadow-color)),
            0 0 0 1px color-mix(in srgb, var(--accent-color) 30%, transparent);
    }
}

/* ── 20. Scroll indicator ── */
#scroll-indicator {
    box-shadow: 0 0 8px 1px color-mix(in srgb, var(--accent-color) 70%, transparent);
}

/* ── 21. Recommended manual card in sidebar ── */
.recommended-manual .manual-card {
    box-shadow:
        0 1px 0 0 color-mix(in srgb, white 8%, transparent) inset,
        0 2px 8px -2px color-mix(in srgb, var(--shadow-color) 50%, transparent);
}

/* ── 22. Overlay backdrops — subtle vignette ── */
#weatherOverlay::before,
#infoOverlay::before,
#customizationOverlay::before {
    content: "";
    position: fixed;
    inset: 0;
    pointer-events: none;
    background: radial-gradient(ellipse at center, transparent 40%, rgba(0,0,0,0.3) 100%);
    z-index: 0;
}

/* ── 23. Timetable row hover — add Z lift ── */
.timetable th:not(:first-child):hover,
.timetable td:not(:first-child):hover {
    box-shadow:
        0 0 0 1px color-mix(in srgb, var(--accent-color) 20%, transparent) inset,
        0 4px 16px -4px color-mix(in srgb, var(--accent-color) 20%, var(--shadow-color)),
        0 8px 24px -8px color-mix(in srgb, var(--shadow-color) 30%, transparent);
}

/* ── 24. Close buttons ── */
.close-btn,
#closeCustomization,
#closeInfoOverlay,
#closeManualsPopup,
#closeTimeOverlay,
#closeTodoOverlay,
#closeTaskEdit,
#closeFolderEdit {
    box-shadow:
        0 1px 0 0 color-mix(in srgb, white 8%, transparent) inset,
        0 2px 6px -2px color-mix(in srgb, var(--shadow-color) 50%, transparent);
}

/* ── 25. FAB (Add Task) ── */
.add-task-btn {
    box-shadow:
        0 1px 0 0 color-mix(in srgb, white 20%, transparent) inset,
        0 -2px 0 0 color-mix(in srgb, black 20%, transparent) inset,
        0 8px 24px -4px color-mix(in srgb, var(--accent-color) 55%, transparent),
        0 4px 8px -2px color-mix(in srgb, black 20%, transparent);
}

/* ── Dark theme adjustments ── */
[data-theme="dark"] body::after,
[data-theme="space"] body::after,
[data-theme="midnight"] body::after {
    opacity: 0.06; /* slightly stronger grain on dark themes */
}

[data-theme="dark"] .timetable th,
[data-theme="dark"] .timetable td {
    background-image: linear-gradient(
        180deg,
        color-mix(in srgb, white 2%, transparent) 0%,
        transparent 40%,
        color-mix(in srgb, black 4%, transparent) 100%
    );
}
