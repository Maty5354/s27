/* ========================================
   WEATHER IMMERSIVE EFFECTS
   Clouds, Particles, Atmosphere
   ======================================== */

/* ─── Animated Cloud Shapes ─────────────────────── */
.wc-cloud {
    position: absolute;
    pointer-events: none;
    will-change: transform;
    animation: wCloudFloat linear infinite;
}

.wc-cloud-body {
    position: relative;
    background: rgba(255,255,255,0.07);
    border-radius: 50px;
    filter: blur(2px);
}
.wc-cloud-body::before,
.wc-cloud-body::after {
    content: '';
    position: absolute;
    background: inherit;
    border-radius: 50%;
}
/* Cloud variant - hero (larger, more opaque near top) */
.wc-cloud.hero {
    opacity: 0.5;
}
/* Cloud variant - background (smaller, more transparent) */
.wc-cloud.bg {
    opacity: 0.12;
    filter: blur(8px);
}
/* Cloud becomes glassy as you scroll away from hero */
.wc-cloud.glassy {
    opacity: 0.06;
    filter: blur(16px);
}

@keyframes wCloudFloat {
    from { transform: translateX(0); }
    to   { transform: translateX(var(--cloud-travel, 110vw)); }
}

/* ─── Snow Accumulation Piles ───────────────────── */
.snow-pile {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    overflow: hidden;
    pointer-events: none;
    z-index: 5;
    height: var(--snow-pile-height, 0px);
    transition: height 12s ease;
}
.snow-pile canvas {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

/* ─── Fog Layers ─────────────────────────────────── */
.fog-wisp {
    position: absolute;
    pointer-events: none;
    border-radius: 50%;
    background: radial-gradient(ellipse, rgba(200,215,220,0.18) 0%, transparent 70%);
    animation: fogDrift linear infinite;
    filter: blur(20px);
}
@keyframes fogDrift {
    0%   { transform: translateX(0)    translateY(0); }
    33%  { transform: translateX(30px) translateY(-10px); }
    66%  { transform: translateX(-20px) translateY(8px); }
    100% { transform: translateX(0)    translateY(0); }
}

/* Dense fog blur overlay */
.fog-vision-blur {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 6;
    backdrop-filter: blur(var(--fog-blur, 0px));
    background: rgba(160,180,185, var(--fog-opacity, 0));
    transition: backdrop-filter 3s ease, background 3s ease;
}

/* ─── Thunder Flash ──────────────────────────────── */
.thunder-flash {
    position: absolute;
    inset: 0;
    background: rgba(220,240,255,0.92);
    pointer-events: none;
    z-index: 8;
    opacity: 0;
    mix-blend-mode: screen;
}
@keyframes thunderStrike {
    0%   { opacity: 0.0; }
    5%   { opacity: 0.95; }
    10%  { opacity: 0.2; }
    15%  { opacity: 0.85; }
    25%  { opacity: 0.0; }
    100% { opacity: 0.0; }
}
.thunder-flash.active {
    animation: thunderStrike 0.6s ease-out forwards;
}

/* ─── Lightning Bolt SVG overlay ────────────────── */
.lightning-bolt-overlay {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 7;
    opacity: 0;
}
.lightning-bolt-overlay.active {
    opacity: 1;
    animation: lightningFade 0.6s ease-out forwards;
}
@keyframes lightningFade {
    0%   { opacity: 1; }
    40%  { opacity: 0.6; }
    100% { opacity: 0; }
}
.lightning-path {
    fill: none;
    stroke: rgba(180,220,255,0.9);
    stroke-width: 2;
    filter: drop-shadow(0 0 8px rgba(150,200,255,0.9));
}

/* ─── Rain Splash Effect ─────────────────────────── */
.rain-splash {
    position: absolute;
    border-radius: 50%;
    border: 1px solid rgba(200,230,255,0.5);
    pointer-events: none;
    animation: splashRipple 0.5s ease-out forwards;
}
@keyframes splashRipple {
    from { width: 0; height: 0; opacity: 0.8; transform: translate(-50%,-50%); }
    to   { width: 24px; height: 8px; opacity: 0; transform: translate(-50%,-50%); }
}

/* ─── Interactive Rain (mouse-following) ─────────── */
.weather-canvas-interactive {
    position: absolute;
    inset: 0;
    z-index: 1;
    pointer-events: none; /* Canvas receives pointer events via JS */
}

/* ─── Snow Sparkle Overlays on Cards ─────────────── */
.has-snow-effect {
    position: relative;
    overflow: hidden;
}
.snow-on-card {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: var(--snow-card-height, 0px);
    pointer-events: none;
    transition: height 10s ease;
    background: linear-gradient(transparent, rgba(220,235,245,0.25) 50%, rgba(235,245,252,0.45));
    border-radius: 0 0 var(--w-radius-sm, 12px) var(--w-radius-sm, 12px);
}

/* ─── Weather Icon Glow ──────────────────────────── */
.weather-hero-icon.glow-sun {
    filter: drop-shadow(0 0 30px rgba(255,200,50,0.5)) drop-shadow(0 0 60px rgba(255,150,0,0.3));
}
.weather-hero-icon.glow-moon {
    filter: drop-shadow(0 0 20px rgba(200,210,255,0.4)) drop-shadow(0 0 40px rgba(180,200,255,0.2));
}
.weather-hero-icon.glow-storm {
    filter: drop-shadow(0 0 20px rgba(180,200,255,0.6)) drop-shadow(0 0 50px rgba(150,180,255,0.3));
}
.weather-hero-icon.glow-snow {
    filter: drop-shadow(0 0 20px rgba(200,230,255,0.5)) drop-shadow(0 0 40px rgba(180,220,255,0.3));
}

/* ─── Night Sky Stars ────────────────────────────── */
.night-star {
    position: absolute;
    border-radius: 50%;
    background: white;
    pointer-events: none;
    animation: starTwinkle ease-in-out infinite;
}
@keyframes starTwinkle {
    0%,100% { opacity: var(--star-max-opacity, 0.9); transform: scale(1); }
    50%      { opacity: calc(var(--star-max-opacity, 0.9) * 0.3); transform: scale(0.7); }
}

/* Shooting star */
.shooting-star {
    position: absolute;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.9), transparent);
    border-radius: 1px;
    pointer-events: none;
    transform-origin: left center;
    animation: shootingStar 1.5s ease-out forwards;
}
@keyframes shootingStar {
    from { opacity: 1; width: 0; }
    70%  { opacity: 1; }
    to   { opacity: 0; width: 200px; }
}

/* ─── Sun Rays ───────────────────────────────────── */
.sun-ray-canvas {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 50%;
    pointer-events: none;
    z-index: 0;
    opacity: 0.18;
}

/* ─── Chart Sparkline Path ───────────────────────── */
.sparkline-path {
    fill: none;
    stroke: url(#sparkGradient);
    stroke-width: 2.5;
    stroke-linecap: round;
    stroke-linejoin: round;
}
.sparkline-area {
    opacity: 0.18;
    fill: url(#sparkGradient);
}
.sparkline-dot {
    fill: white;
    stroke: rgba(255,255,255,0.5);
    stroke-width: 1.5;
    transition: r 0.2s ease;
}
.sparkline-dot:hover { r: 5; }

/* ─── AQI Bar Gradient Pulse ─────────────────────── */
.aqi-scale-bar::after {
    content: '';
    position: absolute;
    inset: -2px;
    border-radius: inherit;
    background: inherit;
    filter: blur(6px);
    opacity: 0.4;
    z-index: -1;
}

/* ─── Hourly Temperature Arc Chart ──────────────── */
.w-temp-chart-wrap {
    padding: 0 1rem 0.25rem;
    position: relative;
}
.w-temp-chart-scroll {
    overflow-x: auto;
    scrollbar-width: none;
    padding: 0.5rem 0;
}
.w-temp-chart-scroll::-webkit-scrollbar { display: none; }

/* ─── Compass Styles ─────────────────────────────── */
.compass-card {
    background: var(--w-glass);
    border: 1px solid var(--w-glass-border);
    border-radius: var(--w-radius-sm);
    padding: 0.9rem;
    backdrop-filter: blur(8px);
    display: flex;
    align-items: center;
    gap: 0.75rem;
    flex-direction: column;
}
.compass-directions {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0;
    width: 72px;
    text-align: center;
    font-size: 0.6rem;
    font-weight: 700;
    color: var(--w-text-dim);
    position: relative;
}
.compass-directions .c-n { grid-column: 2; color: var(--w-text-muted); }
.compass-directions .c-e { grid-column: 3; grid-row: 2; color: var(--w-text-dim); }
.compass-directions .c-s { grid-column: 2; grid-row: 3; color: var(--w-text-dim); }
.compass-directions .c-w { grid-column: 1; grid-row: 2; color: var(--w-text-dim); }
.compass-needle-svg {
    grid-column: 2; grid-row: 2;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%,-50%);
}

/* ─── Visibility Meter ───────────────────────────── */
.visibility-meter {
    position: relative;
    height: 6px;
    background: rgba(255,255,255,0.1);
    border-radius: 99px;
    overflow: hidden;
    margin-top: 0.35rem;
}
.visibility-fill {
    position: absolute;
    inset: 0;
    height: 100%;
    border-radius: inherit;
    background: linear-gradient(90deg, #93c5fd, #60a5fa);
    transition: width 1s ease;
}

/* ─── Precip Probability Bar ─────────────────────── */
.precip-bar {
    height: 4px;
    border-radius: 99px;
    background: rgba(255,255,255,0.08);
    overflow: hidden;
    margin-top: 0.25rem;
}
.precip-fill {
    height: 100%;
    border-radius: inherit;
    background: linear-gradient(90deg, #60a5fa, #3b82f6);
    transition: width 1s ease;
}

/* ─── Pressure Gauge Arc ─────────────────────────── */
.pressure-gauge-wrap {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.15rem;
}
.pressure-gauge-svg {
    width: 70px;
    height: 40px;
    overflow: visible;
}
.p-gauge-track  { fill: none; stroke: rgba(255,255,255,0.1); stroke-width: 6; stroke-linecap: round; }
.p-gauge-fill   { fill: none; stroke-width: 6; stroke-linecap: round; transition: stroke-dashoffset 1.2s ease; }

/* ─── Dew Point Indicator ────────────────────────── */
.dew-point-comfort {
    display: inline-flex;
    align-items: center;
    gap: 0.3rem;
    font-size: 0.7rem;
    padding: 0.2rem 0.5rem;
    border-radius: 99px;
    font-weight: 600;
    margin-top: 0.2rem;
}
.dew-point-comfort.dry      { background: rgba(250,204,21,0.15); color: #fde047; }
.dew-point-comfort.comfy    { background: rgba(74,222,128,0.15); color: #4ade80; }
.dew-point-comfort.humid    { background: rgba(251,146,60,0.15); color: #fb923c; }
.dew-point-comfort.oppressive { background: rgba(248,113,113,0.15); color: #f87171; }

/* ─── Cloud Cover Ring ───────────────────────────── */
.cloud-cover-ring {
    width: 48px;
    height: 48px;
}
.cloud-ring-track { fill: none; stroke: rgba(255,255,255,0.08); stroke-width: 5; }
.cloud-ring-fill  {
    fill: none;
    stroke: rgba(200,220,255,0.6);
    stroke-width: 5;
    stroke-linecap: round;
    stroke-dasharray: 133;
    stroke-dashoffset: 133;
    transition: stroke-dashoffset 1.2s ease;
    transform: rotate(-90deg);
    transform-origin: center;
}

/* ─── Responsive Charts ──────────────────────────── */
@media (max-width: 480px) {
    .weather-hourly-item { min-width: 52px; padding: 0.55rem 0.7rem; }
    .weather-hourly-item .h-icon { font-size: 1.1rem; }
    .weather-hourly-item .h-temp { font-size: 0.8rem; }
}
